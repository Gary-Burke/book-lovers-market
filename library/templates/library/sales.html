{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="container sales">
    <h3 class="my-3">Welcome to the Book Lover's Market!</h3>

    <div class="d-flex">
        <!-- Search field -->
        <form method="get" class="" id="form-search">
            <input id="search-input" name="search" type="text" placeholder="Title, author or ISBN"
                value="{{ request.GET.search }}" autocomplete="off" class="ps-4 pe-5">

            {% if request.GET.status %}
            <input type="hidden" name="status" value="{{ request.GET.status }}">
            {% endif %}

            {% if request.GET.sort %}
            <input type="hidden" name="sort" value="{{ request.GET.sort }}">
            {% endif %}
        </form>
    </div>

    <!-- Sort icon and dropdown menus -->
    <div class="d-flex align-items-center my-3">
        <i class="fa-solid fa-arrow-down-short-wide " id="library-sort"></i>
        <form method="get" class="ms-1" id="form-sort">
            <select name="sort" onchange="this.form.submit()">
                <option value="author" {% if current_sort == "author" %}selected{% endif %}>Author Up</option>
                <option value="-author" {% if current_sort == "-author" %}selected{% endif %}>Author Down</option>
                <option value="title" {% if current_sort == "title" %}selected{% endif %}>Title Up</option>
                <option value="-title" {% if current_sort == "-title" %}selected{% endif %}>Title Down</option>
                <option value="price" {% if current_sort == "price" %}selected{% endif %}>Price Up</option>
                <option value="-price" {% if current_sort == "-price" %}selected{% endif %}>Price Down</option>
            </select>
        </form>
    </div>

    <!-- Books -->
    <div class="row g-3 mt-1">
        {% for book in sales_list %}
        <div class="book col-12 col-md-6 col-lg-4 col-xl-3">
            <div class="row">
                <div class="col-4">
                    {% if book.cover_url %}
                    <img src="{{ book.cover_url }}" alt="{{ book.title }}">
                    {% else %}
                    <img src="{% static 'images/no-cover.png' %}" alt="No cover">
                    {% endif %}
                </div>
                <div class="col-8 ps-0">
                    <ul class="book-text">
                        <li>{{ book.title }}</li>
                        <li> - {{ book.author }}</li>
                        <li>{{ book.price }}â‚¬</li>
                        <li>Seller Contact: {{ book.user.email }}</li>
                    </ul>
                    <div class="d-flex justify-content-start">
                        <a class="col-1 button-edit me-2 hide" book_id="{{ book.id }}" href="#"><i
                                class="fa-solid fa-pencil"></i></a>
                        <a class="col-1 button-delete me-1 hide" book_id="{{ book.id }}" href="#"><i
                                class="fa-solid fa-xmark"></i></a>
                    </div>
                </div>
            </div>
        </div>

        {% empty %}
        <p>Currently there are no books listed to buy</p>
        {% endfor %}
    </div>

    {% endblock content %}